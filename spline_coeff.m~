function [c] = spline_coeff(x,f)
   %BSPLINEMATRIX Berekent voor kubische splines het stelsel Ac=b van
%continuiteitsvoorwaarden, interpolatievoorwaarden en natuurlijke
%voorwaarden in de klassieke basis 
%   s(x) = aj x^3 + bj x^2 + cj x + dj,         x in [t(j),t(j+1)],
%voor knooppunten t(4),t(5),...,t(end-3) en een function handle f.

n = length(x)-1;

A = zeros(4*n);
b = zeros(4*n,1);

A(1:3*(n-1),:) = splinematrix(x);

% interpolatievoorwaarden
% t_0,...,t_(n-1)
for k = 1:n
    A(3*(n-1)+k,4*k-3:4*k) = [ x(k)^3  x(k)^2  x(k)  1 ];
    b(3*(n-1)+k) = f(k);
end
% t_n
A(4*n-2,4*n-3:4*n) = [ x(n+1)^3  x(n+1)^2  x(n+1)  1 ];
b(4*n-2) = f(n+1);

% natuurlijke voorwaarden in t_0 en t_n
% -------------
A(4*n-1,1:4) = [6*x(1)  2   0   0];
b(4*n-1) = 0; 
A(4*n,4*n-3:4*n) = [6*x(n+1)  2   0   0];
b(4*n) = 0; 
disp(b);
c = A\b;
end    

